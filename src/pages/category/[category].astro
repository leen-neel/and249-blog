---
import Layout from '~/layouts/Layout.astro';
import BaseHead from '~/components/BaseHead.astro';
import Card from '~/components/Card.astro';
import Header from '~/components/Header.astro';
import Footer from '~/components/Footer.astro';

import type { Post } from '~/types/post';
import { SITE_TITLE, DESCRIPTION } from '~/config';

export async function getStaticPaths() {
    const posts = await Astro.glob<Post>('../blog/*.{md,mdx}');

    const categories = new Set<string>();
    posts.map((post) => {
        categories.add(post.frontmatter.category.toLowerCase());
    });
    return Array.from(categories).map((category) => {
        const filteredPosts: Post[] = posts.filter(
            (post) => post.frontmatter.category.toLowerCase() === category
        );

        return {
            params: {
                category: category,
            },
            props: {
                posts: filteredPosts,
                category: category,
            },
        };
    });
}
const { category } = Astro.params;
const { posts } = Astro.props;
function capitalize(word: string) {
    return word[0].toUpperCase() + word.substring(1);
}
const title = `${capitalize(category)} | ${SITE_TITLE}`;
---

<Layout title={title}>
    <body>
        <h2 style="margin-bottom: 10px;">
            Category: <strong>{capitalize(category)}</strong>
        </h2>

        <div class="grid">
            {posts.map((post: Post) => <Card post={post} />)}
        </div>
    </body>
</Layout>
